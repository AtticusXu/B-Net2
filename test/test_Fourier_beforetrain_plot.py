import matplotlib.pyplot as plt
import numpy as np

y_2 = [[9.75407561e-01, 2.69845254e-01, 4.34568580e-02, 6.38663406e-03,
  8.67030789e-04, 1.11390949e-04, 1.36761601e-05, 1.67342409e-06],
 [5.10083360e-01, 5.24729305e-02, 4.18282204e-03, 2.83509527e-04,
  1.79271084e-05, 1.16472943e-06, 2.42931029e-07, 2.68475578e-07],
 [1.64780097e-01, 7.68528977e-03, 2.82128302e-04, 9.65453101e-06,
  3.76391242e-07, 2.27381740e-07, 2.62411854e-07, 3.14805257e-07],
 [4.34943071e-02, 1.05780018e-03, 2.11096212e-05, 4.43224206e-07,
  2.40620790e-07, 2.63115329e-07, 2.64189961e-07, 3.33460355e-07]]
 
p_2 = [[-2.893059670848504, 15.701072918185310],
       [-3.878477178847528, 19.144422022058624],
       [-4.711643277648573, 21.097891403143436],
       [-5.539431377008437, 23.245067315267672]]

fig = plt.figure(0,figsize=(10,8))
k = np.linspace(5,12,8)
plt.scatter(k[1:],np.log2(y_2[0][1:]),c = 'b',marker = '*', label = 'r = 3')
plt.plot([5.9,12.1],[p_2[0][0]*5.9+p_2[0][1],p_2[0][0]*12.1+p_2[0][1]] ,
         c = 'b',linewidth=0.5)

plt.scatter(k[1:-2],np.log2(y_2[1][1:-2]),c = 'r',marker = '+', label = 'r = 4')
plt.plot([5.9,10.1],[p_2[1][0]*5.9+p_2[1][1],p_2[1][0]*10.1+p_2[1][1]] ,
         c = 'r',linewidth=0.5)

plt.scatter(k[:-3],np.log2(y_2[2][:-3]),c = 'y',marker = 'd', label = 'r = 5')
plt.plot([4.9,9.1],[p_2[2][0]*4.9+p_2[2][1],p_2[2][0]*9.1+p_2[2][1]] ,
         c = 'y',linewidth=0.5)

plt.scatter(k[:-4],np.log2(y_2[3][:-4]),c = 'purple',marker = 'x', label = 'r = 6')
plt.plot([4.9,8.1],[p_2[3][0]*4.9+p_2[3][1],p_2[3][0]*8.1+p_2[3][1]] ,
         c = 'purple',linewidth=0.5)

la = {'family' : 'Times New Roman',
'weight' : 'normal',
'size' : 24,
}
plt.legend(prop=la)
plt.xlabel('Level L',la)
plt.ylabel('$log_2(error)$',la)
plt.tick_params(labelsize=20)
plt.savefig("K64P2.eps" ,rasterized=True)